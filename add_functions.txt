
  // Riformatta conclusioni con AI
  const handleReformat = async () => {
    setReformatting(true);
    try {
      const response = await axios.post(`/api/assessment/${id}/reformat-conclusions`, {
        text: editedConclusions
      });
      setEditedConclusions(response.data.formatted_text);
      alert('✅ Testo riformattato!');
    } catch (error) {
      console.error('Errore riformattazione:', error);
      alert('❌ Errore durante la riformattazione');
    } finally {
      setReformatting(false);
    }
  };

  // Salva conclusioni finali
  const handleSaveConclusions = async () => {
    try {
      await axios.post(`/api/assessment/${id}/save-conclusions`, {
        text: editedConclusions
      });
      setAiConclusions(editedConclusions);
      setIsEditingAI(false);
      alert('✅ Conclusioni salvate!');
    } catch (error) {
      console.error('Errore salvataggio:', error);
      alert('❌ Errore durante il salvataggio');
    }
  };
